<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Permissions | OpenMod Docs </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Permissions | OpenMod Docs ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
    <link rel="stylesheet" href="../../styles/colors.css">
    <link rel="stylesheet" href="../../styles/discord.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>

  <body>
        <div class="top-navbar">

            <a href="javascript:void(0);" class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="24" height="24" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../../index.html">
              <img src="../../logo.png" alt="OpenMod Docs" class="logomark">
              <span class="brand-title">OpenMod Docs</span>
            </a>
        </div>

        <div class="body-content">

            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../../index.html">
                        <img src="../../logo.png" alt="OpenMod Docs" class="logomark">
                        <span class="brand-title">OpenMod Docs</span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>


                    <div class="sidebar-item-separator"></div>

                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>

                </div>

                <div class="footer">
                  OpenMod .NET Plugin Framework.
                  
                </div>
            </nav>

            <main class="main-panel">

                <div role="main" class="hide-when-search">

                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="permissions">Permissions</h1>

<p>Permissions allow defining which actions a user is permitted to execute and which they are not.</p>
<p>You can use the <code>IPermissionChecker</code> service to check if a user has specific permissions:</p>
<pre><code class="lang-c#">// read the event documentation for more information about event listeners
public class UserConnectBroadcaster : IEventListener&lt;UserConnectedEvent&gt; 
{
    private readonly IPermissionChecker m_PermissionChecker;
    private readonly IUserManager m_UserManager;

    public UserConnectEventListener(
        IPermissionChecker permissionChecker,
        IUserManager userManager)
    {
        m_PermissionChecker = permissionChecker;
        m_UserManager = userManager;
    }

    public async Task HandleEventAsync(object sender, UserConnectedEvent @event)
    {
        var user = @event.User;
        
        if(await m_PermissionChecker.CheckPermissionAsync(user, &quot;announce.join&quot;) == PermissionGrantResult.Grant)
        {
            await m_UserManager.BroadcastAsync(user.Type, $&quot;{user.DisplayName} has joined.&quot;);
        }
    }
}
</code></pre>
<p>Let's have a closer look at <code>CheckPermissionAsync</code>.
<code>CheckPermissionAsync</code> returns <code>PermissionGrantResult</code>, which is an enum with the following members:</p>
<ul>
<li><p><strong>Default</strong> - The permission is neither explicitly granted nor explicitly denied</p>
</li>
<li><p><strong>Grant</strong> - The permission was explicitly granted</p>
</li>
<li><p><strong>Deny</strong> - The permission was explicitly denied</p>
</li>
</ul>
<p>Usually you want to check if the result equals to <code>PermissionGrantResult.Grant</code> to permit an action. This means that if no explicit permission is set, the action will be denied by default. If you want to execute an action unless it is explicitly denied, use <code>CheckPermissionAsync(..) != PermissionGrantResult.Deny</code> instead.</p>
<h2 id="adding-your-own-permission-store">Adding your own permission store</h2>
<p>You can add your own permissions store (e.g. to store permissions in MySQL):</p>
<p>Implement the IPermissionStore interface and register it via a <a href="services.html">ServiceConfigurator</a>:</p>
<pre><code class="lang-c#">public class ServiceConfigurator : IServiceConfigurator
{
    public void ConfigureServices(IOpenModStartupContext openModStartupContext, IServiceCollection serviceCollection)
    {
        serviceCollection.Configure&lt;PermissionCheckerOptions&gt;(options =&gt;
        {
            options.AddPermissionSource&lt;YourPermissionStore&gt;();
        });        
    }
}
</code></pre>
<h2 id="override-permission-checks">Override permission checks</h2>
<p>Sometimes you may want to check yourself if an actor has a permission.</p>
<p>Implement your IPermissionCheckSource register it via a <a href="services.html">ServiceConfigurator</a>:</p>
<pre><code class="lang-c#">public class ServiceConfigurator : IServiceConfigurator
{
    public void ConfigureServices(IOpenModStartupContext openModStartupContext, IServiceCollection serviceCollection)
    {
        serviceCollection.Configure&lt;PermissionCheckerOptions&gt;(options =&gt;
        {
            options.AddPermissionCheckSource&lt;YourPermissionCheckSource&gt;();
        });        
    }
}
</code></pre>
<p>The following example will grant all permissions to Unturned admins:</p>
<pre><code class="lang-c#">public class UnturnedAdminPermissionCheckProvider : IPermissionCheckProvider
{
    public bool SupportsActor(IPermissionActor actor)
    {
        /* only apply to unturned admins */
        return actor is UnturnedUser user &amp;&amp; user.SteamPlayer.isAdmin;
    }

    public Task&lt;PermissionGrantResult&gt; CheckPermissionAsync(IPermissionActor actor, string permission)
    {
        /* grant any permission */
        return Task.FromResult(PermissionGrantResult.Grant);
    }
}
</code></pre>
</article>
              
                </div>
            </main>
        </div>

        
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<script type="text/javascript" src="../../styles/jquery.twbsPagination.js"></script>
<script type="text/javascript" src="../../styles/url.min.js"></script>
<!--<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>-->
<script type="text/javascript" src="../../styles/docfx.js"></script>
<script type="text/javascript" src="../../styles/main.js"></script>

    </body>

</html>
